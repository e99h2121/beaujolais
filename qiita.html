<!DOCTYPE html>
<html lang="ja">
<head>
    <title>Qiita Tags</title>
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script type="text/javascript">
    
    //画面構築完了後
    function jump(pos){
      switch (pos){
      case 'first':
        $("#page").val(['1']);
        break;
      case 'before':
        if (parseInt($("#page").val()) > 1) {
          $("#page").val(parseInt($("#page").val())-1);
        }
        break;
      case 'after':
        if (parseInt($("#page").val()) < 100) {
          $("#page").val(parseInt($("#page").val())+1);
        }
        break;
      case 'last':
        $("#page").val(['100']);
        break;
      default:
        $("#page").val(['1']);
      }
      jumpPage();
    }
    function jumpPage(){
        var page =  $("#page").val();
        $.getJSON("https://qiita.com/api/v2/tags?page=" +page+ "&per_page=100&sort=count", function(json){
            //テーブルクリア
            $("#tbl").find("tr:gt(0)").remove();
            var rows = "";
            //テーブルとして表示するため、htmlを構築
            for (i = 0; i < json.length; i++) {
                rows += "<tr>";
                rows += "<td>";
                rows += i+1+(page*100-100);
                rows += "</td>";
                rows += "<td>";
                rows += "<img border=0 src=\""+ json[i].icon_url +"\" width=\"32\" height=\"32\" alt=\"not available\"> ";
                rows += "</td>";
                rows += "<td>"; 
                rows += "<a href=\"https://qiita.com/tags/"+ json[i].id +"\" target=\"_blank\">"+ json[i].id +"</a>";
                rows += "</td>";
                rows += "<td>";
                rows += json[i].items_count;
                rows += "</td>";
                rows += "<td>";
                rows += json[i].followers_count;
                rows += "</td>";
                rows += "</tr>";
            }
            //テーブルに作成したhtmlを追加する
            $("#tbl").append(rows);
        });
    }
    $(function() {
        //fetchボタンのクリック
        $("#fetch").click(function(){
            jumpPage();
        });
    });
    window.onload = jumpPage;
    </script>
    <style>
      table{
        width: 70%;
        border-spacing: 0;
      }
      table th{
        border-bottom: solid 2px #fb5144;
        padding: 10px 0;
      }
      table td{
        border-bottom: solid 2px #ddd;
        text-align: center;
        padding: 10px 0;
      }
      .arrow {
        cursor: pointer;
        display: flex;
        justify-content: flex-start;
      }
      .arrow > *{
        width: 5%;
        background: #fff;
      }
      
    </style>
</head>
<body>
    <p><label>Qiita: 記事数の多いタグランキング</label></p>
    <input id="page" type="number" size="10" value="1" max="100" min="1"><input id="fetch" type="button" value="ページ目のデータ取得" />
    <div class="arrow">
    <p><img border=0 src="./images/double-arrow-point-to-left.png" width="16" height="16" alt="left" onclick="jump('first')" alt="最初へ" title="最初へ"></p>
    <p><img border=0 src="./images/arrow-point-to-left.png" width="16" height="16" alt="left" onclick="jump('before')" alt="前へ" title="前へ"></p>
    <p><img border=0 src="./images/arrow-point-to-right.png" width="16" height="16" alt="left" onclick="jump('after')" alt="次へ" title="次へ"></p>
    <p><img border=0 src="./images/double-arrow-point-to-right.png" width="16" height="16" alt="left" onclick="jump('last')" alt="最後へ" title="最後へ"></p>
    </div>
    <table id="tbl">
        <tbody>
            <tr>
                <th>順位</th><th>アイコン</th><th>タグ</th><th>記事数</th><th>フォロワー数</th>
            </tr>
        </tbody>
    </table>
</body>
</html>
